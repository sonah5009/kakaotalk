(()=>{var e={};e.id=41,e.ids=[41],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9491:e=>{"use strict";e.exports=require("assert")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},7130:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>h,tree:()=>c});var r=s(7096),a=s(6132),o=s(7284),n=s.n(o),l=s(2564),i={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>l[e]);s.d(t,i);let c=["",{children:["dashboard",{children:["chat",{children:["[roomKey]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,6738)),"/Users/sonah/sonah-git/웹프실/kakaotalk/app/dashboard/chat/[roomKey]/page.jsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,4075)),"/Users/sonah/sonah-git/웹프실/kakaotalk/app/dashboard/layout.jsx"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,7481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,3497)),"/Users/sonah/sonah-git/웹프실/kakaotalk/app/layout.jsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,7481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["/Users/sonah/sonah-git/웹프실/kakaotalk/app/dashboard/chat/[roomKey]/page.jsx"],u="/dashboard/chat/[roomKey]/page",m={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/chat/[roomKey]/page",pathname:"/dashboard/chat/[roomKey]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},3555:(e,t,s)=>{Promise.resolve().then(s.bind(s,4805))},4805:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var r=s(784),a=s(9885),o=s(4997),n=s(7114);let __WEBPACK_DEFAULT_EXPORT__=()=>{let[e,t]=(0,a.useState)(null),[s,l]=(0,a.useState)(null),[i,c]=(0,a.useState)(""),d=(0,a.useRef)(null),u=(0,a.useCallback)(()=>{d.current&&(d.current.scrollTop=d.current.scrollHeight)},[]);function convertToReadableTime(e){let t=e.split(" ")[1],[s,r]=t.split(":"),a=parseInt(s,10)%12||12,o=12>parseInt(s,10)?"오전":"오후";return`${o} ${a}:${r}`}let m=(0,n.usePathname)(),h=(0,n.useSearchParams)(),p=`${m}?${h}`,x=function(e){let t=e.match(/\d+/);return t?t[0]:null}(p),g=(0,a.useCallback)(async()=>{try{let e=await o.Z.get("http://localhost:8000/messages",{params:{room_key:x}});l(e.data),setTimeout(u,0)}catch(e){console.error("Error fetching messages:",e)}},[x,u]),f=(0,a.useCallback)(async e=>{if(e&&e.preventDefault(),i.trim())try{let e=localStorage.getItem("user_key");t(e),await o.Z.post("http://localhost:8000/insert-message",{message:i,user_key:e,room_key:x}),c(""),await g(),setTimeout(u,0)}catch(e){console.error("Error sending message:",e)}},[i,x,g,u]),handleKeyDown=e=>{13!=e.keyCode||e.shiftKey||(e.preventDefault(),f(e))};(0,a.useEffect)(()=>{let e=localStorage.getItem("user_key");t(e),g();let s=document.getElementById("message");return s&&s.addEventListener("keydown",handleKeyDown),()=>{s&&s.removeEventListener("keydown",handleKeyDown)}},[]);let formatMessageWithBr=e=>({__html:e.replace(/\n/g,"<br>")});return r.jsx("div",{className:"flex flex-col w-full h-full overflow-scroll bg-primary-skyblue",children:(0,r.jsxs)("div",{className:"flex flex-col justify-between h-full ",children:[r.jsx("div",{className:"w-full p-3 font-bold bg-primary-skyblue/90",children:"Messages"}),r.jsx("div",{className:"h-full px-5 overflow-y-scroll",id:"background-left",ref:d,children:s&&s.length>0?r.jsx("ul",{children:s.map((t,s)=>r.jsx("li",{children:t.user_key!=e?(0,r.jsxs)("div",{className:"left-container",children:[(0,r.jsxs)("div",{className:"left-id",children:[" ",t.username]}),(0,r.jsxs)("div",{className:"chat-container",children:[r.jsx("div",{className:"break-words user-chat-box w-fit max-w-[200px] overflow-wrap color-white",dangerouslySetInnerHTML:formatMessageWithBr(t.message)}),r.jsx("div",{className:"time-box",children:convertToReadableTime(t.time_stamp)})]})]}):(0,r.jsxs)("div",{className:"chat-container line-right",children:[r.jsx("div",{className:"time-box-right",children:convertToReadableTime(t.time_stamp)}),r.jsx("div",{className:"break-words user-chat-box w-fit max-w-[200px] overflow-wrap color-yellow",dangerouslySetInnerHTML:formatMessageWithBr(t.message)})]})},s))}):r.jsx("div",{children:"No messages found."})}),r.jsx("div",{className:"rounded-t-lg h-[100px]",children:(0,r.jsxs)("form",{className:"flex flex-col items-end h-full bg-white rounded-br-sm ",children:[r.jsx("textarea",{className:"w-full border-none outline-none resize-none",name:"text",id:"message",cols:"50",rows:"10",value:i,onChange:e=>c(e.target.value),onKeyDown:handleKeyDown}),r.jsx("button",{type:"submit",className:"send-box",id:"btn_send",onSubmit:f,children:"Send"}),r.jsx("div",{className:"mb-2"})]})})]})})}},6738:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>o,default:()=>i});var r=s(5153);let a=(0,r.createProxy)(String.raw`/Users/sonah/sonah-git/웹프실/kakaotalk/app/dashboard/chat/[roomKey]/page.jsx`),{__esModule:o,$$typeof:n}=a,l=a.default,i=l}};var t=require("../../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[61,1,997,440,194,253,228],()=>__webpack_exec__(7130));module.exports=s})();